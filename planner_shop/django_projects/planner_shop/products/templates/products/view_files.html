<!DOCTYPE html>
<html>
<head>
    <title>–ü—Ä–æ—Å–º–æ—Ç—Ä —Ñ–∞–π–ª–æ–≤ - Planner Shop</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="{% url 'home' %}">Planner Shop</a>
            <div class="navbar-nav">
                <a class="nav-link" href="{% url 'product_list' %}">–¢–æ–≤–∞—Ä—ã</a>
                <a class="nav-link" href="{% url 'product_create' %}">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</a>
                <a class="nav-link" href="{% url 'import_products' %}">–ò–º–ø–æ—Ä—Ç JSON</a>
                <a class="nav-link" href="{% url 'view_files' %}">–§–∞–π–ª—ã</a>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <h2>–ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö JSON —Ñ–∞–π–ª–æ–≤</h2>
        
        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            {% endfor %}
        {% endif %}

        {% if not files_data %}
            <div class="alert alert-info">
                <h4>–ù–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤</h4>
                <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ JSON —Ñ–∞–π–ª—ã —á–µ—Ä–µ–∑ <a href="{% url 'import_products' %}">—Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–º–ø–æ—Ä—Ç–∞</a>.</p>
            </div>
        {% else %}
            <div class="mb-3">
                <span class="badge bg-primary">–ù–∞–π–¥–µ–Ω–æ —Ñ–∞–π–ª–æ–≤: {{ files_data|length }}</span>
            </div>

            {% for file in files_data %}
            <div class="card mb-4">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">
                        üìÑ {{ file.filename }}
                    </h5>
                    <span class="badge bg-secondary">{{ file.size }} –±–∞–π—Ç</span>
                </div>
                <div class="card-body">
                    {% if file.error %}
                        <div class="alert alert-danger">
                            <strong>–û—à–∏–±–∫–∞:</strong> {{ file.error }}
                        </div>
                    {% else %}
                        <h6>–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞:</h6>
                        <pre class="bg-light p-3 border rounded"><code>{{ file.content|pprint }}</code></pre>
                        
                        <div class="mt-3">
                            <h6>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–≤–∞—Ä–µ:</h6>
                            <ul class="list-group">
                                <li class="list-group-item">
                                    <strong>–ù–∞–∑–≤–∞–Ω–∏–µ:</strong> {{ file.content.title }}
                                </li>
                                <li class="list-group-item">
                                    <strong>–¢–∏–ø:</strong> {{ file.content.product_type }}
                                </li>
                                <li class="list-group-item">
                                    <strong>–¶–µ–Ω–∞:</strong> {{ file.content.price }} —Ä—É–±.
                                </li>
                                <li class="list-group-item">
                                    <strong>–ê—Ä—Ç–∏–∫—É–ª:</strong> {{ file.content.sku }}
                                </li>
                                <li class="list-group-item">
                                    <strong>–í –Ω–∞–ª–∏—á–∏–∏:</strong> 
                                    {% if file.content.is_available %}
                                        <span class="badge bg-success">–î–∞</span>
                                    {% else %}
                                        <span class="badge bg-danger">–ù–µ—Ç</span>
                                    {% endif %}
                                </li>
                            </ul>
                        </div>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        {% endif %}

        <div class="mt-3">
            <a href="{% url 'import_products' %}" class="btn btn-primary">–ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª</a>
            <a href="{% url 'product_list' %}" class="btn btn-success">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–æ–≤–∞—Ä—ã</a>
            <a href="{% url 'home' %}" class="btn btn-secondary">–ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>